# robloxtest
Generated by [Rojo](https://github.com/rojo-rbx/rojo) 7.7.0-rc.1.

## Project Structure

This is a **multi-place** Roblox game with shared code:

```
robloxtest/
├── places/
│   ├── arena/                    -- Main gameplay place
│   │   ├── default.project.json
│   │   └── src/
│   │       ├── client/
│   │       ├── server/
│   │       └── shared/           -- Arena-specific shared code
│   │
│   └── lobby/                    -- Lobby/menu place
│       ├── default.project.json
│       └── src/
│           ├── client/
│           ├── server/
│           └── shared/           -- Lobby-specific shared code
│
├── shared/                       -- Shared across ALL places
│   ├── data/                     -- Item/Achievement definitions
│   ├── services/                 -- Shared service logic
│   ├── util/                     -- Utility functions
│   └── RemoteEvents.luau         -- Shared remote events
│
├── docs/                         -- Documentation
└── aftman.toml                   -- Tooling config
```

## Getting Started

### Building a Place

```bash
# Build Arena
cd places/arena
rojo build -o "arena.rbxlx"

# Build Lobby  
cd places/lobby
rojo build -o "lobby.rbxlx"
```

### Serving a Place (Development)

```bash
# Serve Arena (in one terminal)
cd places/arena
rojo serve

# Serve Lobby (in another terminal)
cd places/lobby
rojo serve
```

Then open the respective `.rbxlx` file in Roblox Studio and connect to the Rojo server.

### Publishing Places

1. Publish each place as a separate Roblox experience/place
2. Configure `ARENA_PLACE_ID` in `places/lobby/src/server/MainServer.server.luau`
3. Use `TeleportService` to move players between places

## Shared Code

The top-level `shared/` folder contains code used by BOTH places:

| Folder | Contents |
|--------|----------|
| `shared/data/` | `ItemRegistry`, `AchievementRegistry`, `PlayerDataTypes`, `ShopRegistry` |
| `shared/util/` | `Log` utility |
| `shared/services/` | (Future) Shared service logic |
| `shared/RemoteEvents.luau` | All remote event definitions |

Both places reference this via their `default.project.json`:
```json
"Shared": {
  "$path": "../../shared"
}
```

## Places Overview

### Arena (Main Gameplay)
- Animal flocking and capture
- Team-based scoring
- Shooting, feeding, scaring mechanics
- Full inventory/achievement/shop systems

### Lobby
- Player stats display
- Shop access
- Matchmaking queue
- Teleport to arena

For more help, check out [the Rojo documentation](https://rojo.space/docs).

---

## GUI Hierarchy & Controller Mapping
The current `PlayerGui` tree (captured from runtime) and the modules controlling each element:

```
PlayerGui [PlayerGui]
	Freecam [ScreenGui]
		FreecamScript [LocalScript]
	ActionsGui [ScreenGui]
		Frame [Frame]
			UIGridLayout [UIGridLayout]
			ShootButton [TextButton]
				Frame
					ClickSound [Sound]
					Main [Frame]
						UICorner [UICorner]
						UIGradient [UIGradient]
						TextLabel [TextLabel]
					Shadow [Frame]
						UICorner [UICorner]
			RunButton [TextButton]
				(same nested structure as ShootButton)
			ResetButton [TextButton]
				(same nested structure as ShootButton)
	StaminaGui [ScreenGui]
		StaminaBarBackground [Frame]
			StaminaFill [Frame]
	HealthGui [ScreenGui]
		HealthBarBackground [Frame]
			HealthFill [Frame]
	ScoreGui [ScreenGui]
		Frame [Frame]
			TextLabel [TextLabel]
```

### Controllers → GUI Elements
| Controller | File | GUI Elements | Purpose |
|------------|------|--------------|---------|
| MenuController | `src/client/ui/MenuController.luau` | `ActionsGui.Frame.ShootButton` | Fire `ShootEvent` when clicked (uses press effect), keyboard E/Q support |
| RunButtonController | `src/client/ui/RunButtonController.luau` | `ActionsGui.Frame.RunButton` | Sprint toggle + Shift key; subscribes to `SprintEvent` |
| StaminaController | `src/client/ui/StaminaController.luau` | `StaminaGui.StaminaBarBackground.StaminaFill` | Visual stamina bar based on `SprintEvent` updates |
| HealthController | `src/client/ui/HealthController.luau` | `HealthGui.HealthBarBackground.HealthFill` | Health bar based on `HealthEvent` |
| TimerController | `src/client/ui/TimerController.luau` | Timer display | Game timer countdown |
| GameEndController | `src/client/ui/GameEndController.luau` | Dynamic overlay | Sequential game end results display |

### Event Dependencies
| RemoteEvent | Produced By | Consumed By |
|-------------|-------------|------------|
| `SprintEvent` | `PlayerSprint.server.luau` | RunButtonController, StaminaController |
| `HealthEvent` | `LifePointsServer.luau` | HealthController |
| `ShootEvent` | (Server listener in ShootServer) | MenuController |
| `TimerUpdateEvent` | `GameTimerService.server.luau` | TimerController |
| `GameEndSequenceEvent` | `GameEndService.luau` | GameEndController |
| `StartGameEvent` | (BindableEvent) | Game systems |
| `TimerEndedEvent` | `GameTimerService.server.luau` | Game end flow |

### Notes & Recommendations
- Buttons share a nested visual structure (`Frame -> Main / Shadow`) used by `ButtonEffects` for press animation.
- Runtime waits (`WaitForChild`) could be removed by mapping GUIs into the filesystem (see below).
- After respawn, controllers should re-init (add a `CharacterAdded` hook in `MainClient` for UI-1 task).
- Keyboard shortcuts: E = Action, Q = Mode cycle, Shift = Sprint, I = Player menu

### GUI Development Approach
**GUIs are created and maintained in Roblox Studio, NOT synced via Rojo.**

Rojo's `.model.json` format has significant limitations (no UIGradient support, limited Font support, unreliable property sync). Studio's GUI editor is the correct tool for visual design.

**Workflow:**
- Create/edit GUIs in Studio's `StarterGui`
- Export as `.rbxmx` files for backup/version control (optional)
- Write controllers in `src/client/ui/` to handle logic
- Controllers sync via Rojo, GUIs stay in Studio

See [docs/GUI_WORKFLOW.md](docs/GUI_WORKFLOW.md) for detailed guidelines.

### Initialization Flow
1. Server bootstrap (`MainServer.server.luau`) creates RemoteEvents.
2. Client `MainClient` requires controllers; each controller binds to its GUI subtree.
3. Controllers listen to events immediately (module scope where needed) before UI waits finish.
4. Game start cleans up previous state, assigns teams, respawns players.
5. Game end freezes everything, shows results UI, then resets for next game.

### Character Respawn Handling (UI-1) ✅
`MainClient.client.luau` includes a `CharacterAdded` hook that re-initializes all controllers after respawn to guarantee UI rebinds.

---